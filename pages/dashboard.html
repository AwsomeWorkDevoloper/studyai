<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>StudyAI - Your personal study buddy</title>
    <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon">

    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/index.js"></script>
    <script src="js/components/navbar.js"></script>
    <script src="js/components/footer.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="style.css">

    <!-- Main Petite vue-->
    <script type="module">
        import { createApp, reactive } from 'https://unpkg.com/petite-vue?module'

        const options = reactive({
            examples: GetExamples(),
            optionSelected: 1,
            selectOption(n) {
                this.optionSelected = n;
            },
            getPromptType() {
                return this.examples[this.optionSelected - 1].topic
            },
            getExamplePrompt() {
                return this.examples[this.optionSelected - 1].prompt
            },
        })

        const context = reactive({
            contextList: [
            ],
            addPrompt(options) {
                this.contextList = [{ prompt: this.currentPromptText, type: options.getPromptType(), chosen: true }, ...this.contextList];
            },
            currentPromptText: '',
            response: 'Waiting for input...'
        })

        createApp({
            options,
            context,
            Footer,

            async go (event) {
                event.preventDefault();

                this.context.addPrompt(this.options);

                let response = await submitPrompt(this.context);

                console.log(response);

                this.context.response = response;
            }
        }).mount();
    </script>
 

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <!-- Fontawesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<!-- Templates -->

<!-- Body -->
<body>
    <!-- Main body -->
    <main class="row">
        <!-- Sidebar -->
        <div class="col-2 sidebar" v-scope>
            <div class="row">
                <div class="col-3 text-left">
                    <img src="assets/study_ai_aura.svg" width="36" height="36" alt="Logo"/>
                </div>
                <div class="col">
                    <a href="/" class="link">
                        <h3>StudyAI</h3>
                    </a>
                </div>
            </div>

            <div class="row-4 pt-5">
                <div class="col w-75 m-auto text-center">
                    <div 
                        v-for="(option, i) in options.examples"
                        :class="['row', 'd-button', 'option-btn', 'mt-3', 'mb-3', {'option-btn-selected': (options.optionSelected == i + 1)}]" 
                        @click="options.selectOption(i + 1)" 
                    >
                        {{ option.topic }}
                    </div>
                    
                </div>
            </div>
            
            <div class="row-4 w-75 h-50 m-auto d-flex align-items-center">
                <div class="w-100 d-button option-btn" onclick="logout(event)">
                    Logout
                </div>
            </div>
        </div>
        <!-- Prompt section -->
        <div class="col-5 prompt-section" v-scope>
            <div class="row">
                <div class="col-8">
                    <h3>Enter your prompt below</h3>
                </div>
                <div class="col-4 d-flex justify-content-end align-items-center">
                    <div class="d-button link">
                        <i class="fa fa-question-circle" aria-hidden="true"></i>
                    </div>
                </div>
            </div>
            <div class="row-2 pt-5">
                <div class="input-prompt" style="margin: 0;">
                    <p >{{ options.getPromptType() }} Prompt</p>
                    <input type="text" :placeholder="options.getExamplePrompt()" @change="context.currentPromptText = $el.value" />
                </div>
            </div>
            <div class="row-6 h-50 pt-5">
                <div class="input-prompt h-100" style="margin: 0; overflow-y: scroll;">
                    <p >Response</p>
                    <h6 style="white-space: pre-wrap;">{{context.response}}</h6>
                </div>
            </div>
            <div class="row-2 pt-5">
                <div @click="go(event)" class="w-100 d-button secondary-btn">
                    Go
                </div>
            </div>
        </div>
        <!-- Context section -->
        <div class="col-4 context-section">
            <div class="row">
                <div class="col-8">
                    <h3>Context</h3>
                </div>
                <div class="col-4 d-flex justify-content-end align-items-center">
                    <div class="d-button link">
                        <i class="fa fa-question-circle" aria-hidden="true"></i>
                    </div>
                </div>
            </div>
            <div class="row pt-4" v-scope>
                <div class="context-item m-auto" style="min-width: 100%;" v-for="contextItem in context.contextList">
                    <div class="input-prompt d-flex justify-content-center">
                        <div style="width:85%">
                            <p>{{ contextItem.type }} Prompt</p>
                            <span>{{contextItem.prompt}}</span>
                        </div>
                        <div class="d-flex justify-content-center align-items-center">
                            <div :class="['checkbox', {'checkbox-selected': contextItem.chosen}]" @click="contextItem.chosen = !contextItem.chosen">

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <div v-scope="Footer({ })"></div> 
</body>
</html>
